import numpy as np
import matplotlib.pyplot as plt
import pandas
import seaborn as sns
import scipy.stats as st
import matplotlib

matplotlib.rcParams.update(matplotlib.rcParamsDefault)
from numpy import *
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from scipy import stats
import random

plt.clf()

# mean square error and complexity when d = 20
loss1 = np.array([4.59592426, 6.5231719, 7.08415673, 6.37517405, 6.67568299, 6.46470762,
                  6.93637185, 7.20824714, 7.17896051, 7.76595097, 7.19860345, 6.9054635,
                  6.85686229, 6.5838752, 6.28987661, 6.74477453, 7.61914386, 6.8993123,
                  7.30363728, 6.51960642, 7.22076549, 6.71988486, 6.83903219, 7.21100978,
                  6.52443926, 6.89961134, 6.48213993, 6.84924623, 5.77491478, 6.74687009,
                  7.37106327, 6.54567593, 7.07224845, 6.97659915, 6.75060733, 6.82615043,
                  6.74985113, 6.3494978, 7.49376476, 6.47640984, 6.5126386, 7.08767955,
                  6.8733654, 6.14694604, 7.95525919, 6.38391348, 7.15924598, 6.74136682,
                  6.39661601, 6.34671256, 6.34877104, 6.06107991, 6.42629483, 7.14883894,
                  6.10255442, 6.90029725, 6.42673058, 6.16082955, 5.99376591, 6.41284956,
                  5.81441335, 6.43842015, 6.00353345, 6.15012451, 5.56508104, 6.52288526,
                  6.4460559, 5.99214673, 5.58367167, 5.68709055, 5.91180766, 4.880069,
                  5.44671473, 6.24965542, 5.87087501, 5.59212841, 5.67138791, 5.2526565,
                  5.36808475, 5.83157183, 5.8637209, 5.36290713, 5.16124329, 5.55033988,
                  5.43936198, 4.9102836, 4.35851965, 5.48137865, 4.62069555, 4.81721873,
                  4.72876495, 4.36371873, 4.76623051, 4.72012452, 4.86285828, 4.85122257,
                  4.47694813, 4.67854874, 5.03947408, 4.30579637, 4.36894528, 4.28077748,
                  4.1351578, 4.60937443, 4.34002487, 4.24270723, 4.20243764, 4.51678512,
                  4.32597805, 4.46787116, 4.28835148, 4.24241724, 4.77048552, 4.44218333,
                  4.00163616, 4.09563302, 4.54393245, 4.02814653, 3.87239706, 4.04866446,
                  3.98803901, 4.06458548, 4.07762099, 3.89908413, 3.95143418, 3.77042728,
                  3.9284521, 4.00411001, 4.53048602, 4.25378058, 4.14023843, 3.61247807,
                  3.7097757, 3.8010325, 3.48703131, 3.66881105, 3.99372047, 3.71941779,
                  3.45987614, 3.5815165, 4.0919904, 3.47767081, 3.61863325, 3.51022582,
                  3.51914455, 3.98695062, 3.79747242, 3.55407794, 3.34437061, 3.24090383,
                  3.26726669, 3.25170778, 3.11285554, 3.07968929, 3.4688334, 3.36512957,
                  3.63636241, 3.32312186, 3.39019154, 3.38171575, 3.41041346, 3.35720456,
                  3.20465521, 2.99930215, 3.4837496, 3.14670445, 3.11109631, 3.01959026,
                  2.99568803, 3.25977318, 2.49999057, 2.79300981, 3.2014914, 3.47321513,
                  3.22786924, 3.21562843, 3.04854117, 3.17879416, 2.86695313, 2.755917,
                  3.07172568, 2.97695841, 2.90401249, 2.7046936, 2.54273943, 2.57143348,
                  2.61300323, 2.60903298, 2.7425979, 2.37837913, 2.19315877, 2.36687231,
                  2.51241259, 2.54680174, 2.69854167, 2.65342912, 2.66823768, 2.85732065,
                  2.91360308, 2.5501838])/200

complexity1 = np.array([4.04000000e+03, 2.58000000e+04, 7.09800000e+04, 1.23540000e+05,
                        2.05040000e+05, 3.46700000e+05, 5.04100000e+05, 6.69620000e+05,
                        9.44180000e+05, 1.23098000e+06, 1.53410000e+06, 1.99586000e+06,
                        2.47062000e+06, 2.96204000e+06, 3.46634000e+06, 4.04106000e+06,
                        4.89544000e+06, 5.76328000e+06, 6.65670000e+06, 7.56334000e+06,
                        8.48740000e+06, 9.45516000e+06, 1.09526400e+07, 1.24788000e+07,
                        1.40196600e+07, 1.55782800e+07, 1.71525600e+07, 1.88601600e+07,
                        2.05817400e+07, 2.23246800e+07, 2.40936000e+07, 2.58763200e+07,
                        2.87217600e+07, 3.15860800e+07, 3.44664000e+07, 3.73732800e+07,
                        4.03019200e+07, 4.32456000e+07, 4.62628800e+07, 4.92952000e+07,
                        5.23492800e+07, 5.54299200e+07, 5.85265600e+07, 6.16420800e+07,
                        6.48024000e+07, 7.00071800e+07, 7.52314800e+07, 8.04721200e+07,
                        8.59738400e+07, 9.14950200e+07, 9.70326000e+07, 1.02600680e+08,
                        1.08188400e+08, 1.13792460e+08, 1.19442440e+08, 1.25111640e+08,
                        1.30797600e+08, 1.36514060e+08, 1.42249800e+08, 1.48002120e+08,
                        1.53831200e+08, 1.59679500e+08, 1.65544440e+08, 1.71436280e+08,
                        1.81378580e+08, 1.91349860e+08, 2.01344000e+08, 2.11355600e+08,
                        2.21505980e+08, 2.31676220e+08, 2.41864040e+08, 2.52082280e+08,
                        2.62322180e+08, 2.72608340e+08, 2.82910640e+08, 2.93234240e+08,
                        3.03589100e+08, 3.13960940e+08, 3.24356120e+08, 3.34824920e+08,
                        3.45311540e+08, 3.55821380e+08, 3.66359840e+08, 3.76921520e+08,
                        3.87501020e+08, 3.98123420e+08, 4.08769160e+08, 4.19431880e+08,
                        4.30125860e+08, 4.40841140e+08, 4.60037580e+08, 4.79278940e+08,
                        4.98544280e+08, 5.17827780e+08, 5.37142940e+08, 5.56478300e+08,
                        5.75831880e+08, 5.95263140e+08, 6.14716460e+08, 6.34201260e+08,
                        6.53704280e+08, 6.73231220e+08, 6.92803260e+08, 7.12398860e+08,
                        7.32012680e+08, 7.51658100e+08, 7.71325580e+08, 7.91132060e+08,
                        8.10956760e+08, 8.30805380e+08, 8.50683740e+08, 8.70585180e+08,
                        8.90504840e+08, 9.10471460e+08, 9.30460140e+08, 9.50480300e+08,
                        9.70518680e+08, 9.90580980e+08, 1.01071910e+09, 1.03088078e+09,
                        1.05106068e+09, 1.07127218e+09, 1.09150574e+09, 1.11178614e+09,
                        1.13208476e+09, 1.15240730e+09, 1.17275958e+09, 1.19312822e+09,
                        1.22966750e+09, 1.26623110e+09, 1.30282502e+09, 1.33944326e+09,
                        1.37608078e+09, 1.41279638e+09, 1.44953462e+09, 1.48630486e+09,
                        1.52310110e+09, 1.55991590e+09, 1.59677830e+09, 1.63366310e+09,
                        1.67058062e+09, 1.70751670e+09, 1.74447734e+09, 1.78157558e+09,
                        1.81869982e+09, 1.85585606e+09, 1.89303110e+09, 1.93023046e+09,
                        1.96747598e+09, 2.00474582e+09, 2.04203446e+09, 2.07935510e+09,
                        2.11670174e+09, 2.15412454e+09, 2.19157190e+09, 2.22903782e+09,
                        2.26653646e+09, 2.30405750e+09, 2.34162614e+09, 2.37921334e+09,
                        2.41682654e+09, 2.45447174e+09, 2.49213958e+09, 2.53080710e+09,
                        2.56949390e+09, 2.60820502e+09, 2.64694646e+09, 2.68571222e+09,
                        2.72452702e+09, 2.76336038e+09, 2.80221830e+09, 2.84110630e+09,
                        2.88001934e+09, 2.91895094e+09, 2.95796086e+09, 2.99699318e+09,
                        3.03605918e+09, 3.07514950e+09, 3.11425862e+09, 3.15341510e+09,
                        3.19259470e+09, 3.26361868e+09, 3.33467530e+09, 3.40575154e+09,
                        3.47685454e+09, 3.54803620e+09, 3.61924138e+09, 3.69047914e+09,
                        3.76174342e+09, 3.83302684e+09, 3.90435874e+09, 3.97571362e+09,
                        4.04710294e+09, 4.11851764e+09, 4.18995154e+09, 4.26164986e+09,
                        4.33337326e+09, 4.40512780e+09, 4.47690730e+09, 4.54873618e+09]
                       )

# mean square error and complexity as t increases when d=5

loss2 = np.array([7.05134443, 7.76135629, 8.81944092, 8.07255783, 8.72515304, 11.22119944,
                  8.96658401, 10.37582561, 9.11772952, 8.49292892, 9.38663825, 7.28201916,
                  7.3210189, 9.27857153, 7.51977154, 7.68715592, 7.21829328, 5.58656276,
                  6.60408495, 7.34088691, 7.12445414, 6.6164372, 5.8525964, 6.85094876,
                  6.47593739, 4.79418319, 4.90729288, 6.0002741, 4.96904319, 4.95378014,
                  5.3217103, 4.81629352, 5.07047784, 4.73233821, 3.85809534, 3.53877764,
                  3.44565676, 3.17015347, 3.60657416, 4.54929277, 3.93939189, 3.71738547,
                  4.1142425, 3.2185299, 3.20128432, 5.73434916, 3.69959469, 3.31343967,
                  3.0598526, 2.88933003, 3.49869018, 4.65115145, 2.9153595, 3.22648816,
                  2.38211274, 2.60765303, 2.60125888, 3.04022733, 2.81568594, 3.51423599,
                  2.80577546, 2.69754414, 3.30906739, 2.85602721, 2.62040211, 2.22908096,
                  2.68422268, 2.19360663, 3.04330305, 2.70100243, 3.08168777, 2.40181642,
                  2.11008366, 2.01336454, 2.02486337, 1.7576722, 1.92767407, 2.56672922,
                  2.18773189, 2.20840193, 1.93767099, 1.74079571, 2.16378313, 2.90085482,
                  2.53231803, 2.32553244, 2.85334056, 2.4258256, 1.61789489, 1.80219377,
                  1.71564204, 1.966621, 1.97054612, 2.12265066, 2.10529201, 1.97159225,
                  2.40438166, 1.90004298, 1.59612642, 1.5502915, 1.41915922, 1.66897908,
                  1.47962507, 1.44690718, 1.90886957, 2.08875353, 1.79434139, 1.59869138,
                  1.92052082, 2.28324395, 1.73165612, 1.68429292, 1.93895789, 1.66236213,
                  1.41389905, 1.77376379, 1.60412847, 1.41950333, 1.75915553, 1.81640566,
                  1.43274062, 1.12133265, 1.29012446, 1.33381521, 1.30069993, 1.30305512,
                  1.58279663, 1.61209221, 1.56629681, 1.41184645, 1.28942472, 1.3899154,
                  1.392486, 1.34512612, 1.34460308, 1.38842137, 1.20993171, 1.35958563,
                  1.35060258, 1.06828583, 1.31970116, 1.09485416, 1.56684523, 1.21499392,
                  1.35484843, 1.20747901, 0.94417645, 1.12098519, 1.28633563, 1.40226982,
                  1.18161877, 1.13743351, 1.25501816, 1.27927609, 1.59529392, 1.97389603,
                  1.67631717, 1.37793502, 1.4320461, 1.16034883, 0.9790401, 0.90538035,
                  0.84115745, 0.81178349, 0.99630514, 1.25099328, 1.17721344, 1.13777558,
                  1.13633105, 1.11368337, 1.51165178, 1.37009043, 1.23739992, 1.14441505,
                  1.09049807, 0.88175957, 0.91476363, 0.92104188, 1.09297045, 0.75435779,
                  1.04242309, 0.86203981, 1.15617232, 1.61116398, 1.45731149, 1.26014566,
                  1.21947638, 1.0653708, 0.95589805, 1.08344693, 1.09124273, 1.60325986,
                  1.36439154, 0.99486, 1.51739364, 1.32018743, 1.04217529, 0.95517174,
                  0.87949552, 0.78447412]) /200



complexity2 = np.array([3.10000000e+02, 2.55000000e+03, 7.18500000e+03, 1.24050000e+04,
                        2.20000000e+04, 4.05550000e+04, 5.94050000e+04, 7.86250000e+04,
                        1.14145000e+05, 1.50085000e+05, 1.88185000e+05, 2.57785000e+05,
                        3.28155000e+05, 3.98950000e+05, 4.70965000e+05, 5.43285000e+05,
                        6.78380000e+05, 8.13980000e+05, 9.53715000e+05, 1.09389500e+06,
                        1.23485000e+06, 1.37631000e+06, 1.64268000e+06, 1.90974000e+06,
                        2.17735500e+06, 2.44719000e+06, 2.71758000e+06, 2.98872000e+06,
                        3.26041500e+06, 3.53337000e+06, 3.80688000e+06, 4.08072000e+06,
                        4.60968000e+06, 5.13920000e+06, 5.66952000e+06, 6.20040000e+06,
                        6.73256000e+06, 7.26528000e+06, 7.79880000e+06, 8.33288000e+06,
                        8.86920000e+06, 9.40608000e+06, 9.94376000e+06, 1.04820000e+07,
                        1.10215200e+07, 1.20586150e+07, 1.30962900e+07, 1.41347700e+07,
                        1.51747600e+07, 1.62153150e+07, 1.72566900e+07, 1.82986300e+07,
                        1.93428600e+07, 2.03876550e+07, 2.14332700e+07, 2.24794500e+07,
                        2.35270200e+07, 2.45751550e+07, 2.56241100e+07, 2.66736300e+07,
                        2.77388800e+07, 2.88046950e+07, 2.98713300e+07, 3.09385300e+07,
                        3.29944450e+07, 3.50511850e+07, 3.71085400e+07, 3.91672000e+07,
                        4.12265350e+07, 4.32866950e+07, 4.53474700e+07, 4.74124300e+07,
                        4.94784250e+07, 5.15450050e+07, 5.36129200e+07, 5.56814200e+07,
                        5.77508350e+07, 5.98208350e+07, 6.18931300e+07, 6.39660100e+07,
                        6.60399250e+07, 6.81151450e+07, 7.01909800e+07, 7.22676400e+07,
                        7.43449750e+07, 7.64303350e+07, 7.85163100e+07, 8.06031100e+07,
                        8.26914250e+07, 8.47803250e+07, 8.88420750e+07, 9.29044150e+07,
                        9.69676300e+07, 1.01031525e+08, 1.05099655e+08, 1.09168375e+08,
                        1.13238150e+08, 1.17309265e+08, 1.21381075e+08, 1.25453715e+08,
                        1.29526990e+08, 1.33602745e+08, 1.37679375e+08, 1.41756595e+08,
                        1.45835230e+08, 1.49914485e+08, 1.53994795e+08, 1.58106175e+08,
                        1.62218190e+08, 1.66331125e+08, 1.70444695e+08, 1.74559575e+08,
                        1.78675510e+08, 1.82792065e+08, 1.86910995e+08, 1.91030515e+08,
                        1.95150910e+08, 1.99272825e+08, 2.03395375e+08, 2.07518755e+08,
                        2.11642830e+08, 2.15771125e+08, 2.19900475e+08, 2.24030415e+08,
                        2.28161710e+08, 2.32293685e+08, 2.36426535e+08, 2.40559975e+08,
                        2.48641195e+08, 2.56723295e+08, 2.64806095e+08, 2.72890255e+08,
                        2.80975475e+08, 2.89061335e+08, 2.97149575e+08, 3.05238455e+08,
                        3.13328395e+08, 3.21419695e+08, 3.29511695e+08, 3.37604575e+08,
                        3.45701875e+08, 3.53799815e+08, 3.61898695e+08, 3.69998215e+08,
                        3.78099275e+08, 3.86201215e+08, 3.94303855e+08, 4.02408815e+08,
                        4.10514835e+08, 4.18621495e+08, 4.26729575e+08, 4.34838295e+08,
                        4.42948075e+08, 4.51073615e+08, 4.59199855e+08, 4.67326975e+08,
                        4.75455635e+08, 4.83584935e+08, 4.91715175e+08, 4.99846055e+08,
                        5.07979435e+08, 5.16113695e+08, 5.24248655e+08, 5.32384975e+08,
                        5.40522355e+08, 5.48660375e+08, 5.56802695e+08, 5.64945655e+08,
                        5.73089675e+08, 5.81235055e+08, 5.89381135e+08, 5.97528095e+08,
                        6.05677555e+08, 6.13827655e+08, 6.21978695e+08, 6.30130375e+08,
                        6.38283595e+08, 6.46437695e+08, 6.54592495e+08, 6.62755375e+08,
                        6.70919315e+08, 6.86958410e+08, 7.03001945e+08, 7.19046125e+08,
                        7.35091295e+08, 7.51138010e+08, 7.67185385e+08, 7.83233705e+08,
                        7.99284575e+08, 8.15336090e+08, 8.31388565e+08, 8.47441685e+08,
                        8.63496395e+08, 8.79552050e+08, 8.95608365e+08, 9.11726705e+08,
                        9.27846035e+08, 9.43966010e+08, 9.60087545e+08, 9.76209965e+08]
                       )





plt.scatter(complexity1[75:], loss1[75:], s=5, color='blue', label=r'$d=20$')

plt.scatter(complexity2[75:], loss2[75:], s=5, color='green', label=r'$d=5$')

plt.xscale('log')
plt.yscale('log')
plt.ylim(10**(-2), 1)
plt.ylabel(r'$E ||\theta_t-w^*||^2$')
plt.xlabel('computational budget C')
plt.legend(loc='lower left')
plt.savefig("compare_fd.pdf", dpi=10000, bbox_inches='tight')

